# YKAGovernance テスト仕様

## 概要

このドキュメントではYKAトークンのガバナンス機能に関するテスト仕様を説明します。
YKAGovernanceコントラクトの主要機能とそのテストケースを網羅します。

## テストの目的

ガバナンス機能のテストは、以下の目的で実施されます：

1. ガバナンス機能の正常動作の確認
2. 投票メカニズムの検証
3. セキュリティ制御の有効性確認
4. アップグレード機能の安全性確認

## テストケース

### 1. 初期化テスト

```typescript
describe("初期化", () => {
    it("正しく初期化されるべき");
});
```

**検証項目：**
- ガバナンス名が正しく設定されている
- 投票遅延期間が1日（7200ブロック）に設定されている
- 投票期間が1週間（50400ブロック）に設定されている

**期待される結果：**
- 全てのパラメータが想定通りの値で初期化される
- エラーなく初期化が完了する

### 2. 提案作成テスト

```typescript
describe("提案作成", () => {
    it("必要な投票権を持つアカウントが提案を作成できる");
    it("投票権が不足する場合は提案を作成できない");
});
```

**検証項目：**
- 十分な投票権を持つアカウントによる提案作成
- 投票権不足アカウントによる提案作成の制限
- 提案内容の正確な記録

**期待される結果：**
- 投票権を持つアカウントの提案は成功
- 投票権不足の場合は適切なエラーメッセージ
- ProposalCreatedイベントの正しい発行

### 3. 投票機能テスト

```typescript
describe("投票", () => {
    it("有効な投票ができる");
    it("投票期間外では投票できない");
});
```

**検証項目：**
- 投票の実行と記録
- 投票期間の制御
- 投票結果の集計

**期待される結果：**
- 有効期間内の投票は成功
- 期間外の投票は適切にブロック
- VoteCastイベントの正しい発行

### 4. 委任機能テスト

```typescript
describe("委任", () => {
    it("投票権を委任できる");
    it("ゼロアドレスには委任できない");
});
```

**検証項目：**
- 投票権の委任処理
- 委任先の制限チェック
- 委任状態の管理

**期待される結果：**
- 有効なアドレスへの委任は成功
- ゼロアドレスへの委任は失敗
- DelegateChangedイベントの正しい発行

## テストの実行方法

1. テスト環境の準備:
```bash
npm install
```

2. テストの実行:
```bash
npx hardhat test test/governance/YKAGovernance.test.ts
```

## 注意事項

- テスト実行前にHardhat環境が正しく設定されていることを確認
- 十分なガス量が設定されていることを確認
- テストネットワークでの実行を推奨

## エラー条件

1. 提案作成時のエラー
   - 投票権不足: "YKAGovernance: proposer votes below threshold"

2. 投票時のエラー
   - 期間外の投票: "Governor: vote not currently active"

3. 委任時のエラー
   - 無効な委任先: "YKAGovernance: invalid delegatee"

## 今後の拡張予定

## 今後の拡張予定

1. 投票メカニズムの詳細テスト
   - 投票権の委任連鎖テスト
   - 提案実行のシナリオテスト
   - タイムロック制御の詳細テスト